)
# Converter strings de data para tipo Date, se ainda não estiverem
substitute_data$date <- as.Date(substitute_data$date, format = "%Y-%m-%d")
# Substituição dos valores de temperatura
filtered_df <- filtered_df %>%
mutate(
name = ifelse(date %in% substitute_data$date, substitute_data$name[match(date, substitute_data$date)], name),
tmin = ifelse(date %in% substitute_data$date, substitute_data$tmin[match(date, substitute_data$date)], tmin),
tmax = ifelse(date %in% substitute_data$date, substitute_data$tmax[match(date, substitute_data$date)], tmax)
)
filtered_df |> select(name, date, tmin, tmax)
# Dados de substituição
substitute_data <- data.frame(
name = c("SAO PAULO", "SAO PAULO", "SAO PAULO", "SAO PAULO", "SAO PAULO", "SAO PAULO"),
date = c("2022-09-01", "2022-09-02", "2022-09-03", "2022-09-04", "2022-09-05", "2022-09-06"),
tmin = c(10.3, 12.5, 15.5, 10, 11.3, 13.7),
tmax = c(26.9, 30.2, 23.7, 15.1, 19.3, 23.9)
)
# Converter strings de data para tipo Date, se ainda não estiverem
substitute_data$date <- as.Date(substitute_data$date, format = "%Y-%m-%d")
# Substituição dos valores de temperatura
filtered_df <- filtered_df %>%
mutate(
name = ifelse(date %in% substitute_data$date, substitute_data$name[match(date, substitute_data$date)], name),
tmin = ifelse(date %in% substitute_data$date, substitute_data$tmin[match(date, substitute_data$date)], tmin),
tmax = ifelse(date %in% substitute_data$date, substitute_data$tmax[match(date, substitute_data$date)], tmax)
)
filtered_df<-filtered_df |> select(name, date, tmin, tmax)
#| message: false
#| warning: false
# Use o ggtext para o subtitle que requer HTML
my_title <- glue(
"Registros diários de temperaturas <b><span style = 'color:blue;'>mínimas</span></b> e <b><span style = 'color:orange;'>máximas</span></b> em Austin durante meu intercâmbio"
)
# Cria o gráfico
figura <- ggplot(
filtered_df, aes(x = date)) +
geom_rect(aes(xmin = as.Date("2022-09-01"), xmax = as.Date("2022-09-06"), ymin = -Inf, ymax = Inf), fill = "red", alpha =0.01) +
geom_rect(aes(xmin = as.Date("2022-09-07"), xmax = as.Date("2022-12-22"), ymin = -Inf, ymax = Inf), fill = "orange", alpha = 0.01) +
geom_rect(aes(xmin = as.Date("2022-12-23"), xmax = max(filtered_df$date), ymin = -Inf, ymax = Inf), fill = "lightblue", alpha = 0.01) +
geom_segment(aes(x = date, xend = date, y = tmin, yend = tmax)) +
geom_point(aes(y = tmin), color = "blue", size = 1) +
geom_point(aes(y = tmax), color = "orange", size = 1) +
bbc_style() +
labs(title = "Põe o casaco, tira o casaco",
subtitle = my_title,
x = "Dia",
y = "Temperatura (°C)") +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
geom_vline(data = data.frame(date = seq(min(filtered_df$date), max(filtered_df$date), by = "1 month")),
aes(xintercept = date), linetype = "dashed", color = "gray") +
theme(axis.text.x = element_text(angle = 0, vjust = 0.5, hjust = -1, size = 10),
plot.subtitle = ggtext::element_markdown())
figura
# Adicionar anotações com setas
p <- figura +
theme_void() +
annotate(
"text",
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin) - 5,
label = "Menor temperatura aconteceu \nno outono: dia 13/11, 1°C",
hjust = 0,
vjust = 0,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax) + 5,
label = "O dia mais quente: \n22/09, 37°C",
hjust = 1,
vjust = -0.75,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_amplitude$date,
y = max(filtered_df$tmax) + 10,
label = "No dia 20/10 encarei uma diferença de 20°C \nentre as temperaturas mínima e máxima!",
hjust = 0.5,
vjust = 1,
size = 3,
color = "black") +
geom_curve(
aes(
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin),
xend = dia_com_menor_temperatura$date,
yend = min(filtered_df$tmin) - 2),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax),
xend = dia_com_maior_temperatura$date,
yend = max(filtered_df$tmax) + 8),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_amplitude$date,
y = (max(filtered_df$tmax) + min(filtered_df$tmin)) / 2,
xend = dia_com_maior_amplitude$date,
yend = max(filtered_df$tmax) + 4),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
theme(
axis.text.x = element_text(angle = 0, vjust = 0.5, size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold"), # Diminui o tamanho do título
plot.subtitle = ggtext::element_markdown()) # Use o markdown para o subtítulo# Diminui o tamanho do subtítulo
dia_com_menor_temperatura <- temp_clean %>% filter(tmin == min(tmin))
dia_com_menor_temperatura <- filtered_df %>% filter(tmin == min(tmin))
dia_com_maior_temperatura <- filtered_df %>% filter(tmax == max(tmax))
dia_com_maior_amplitude <- filtered_df %>% mutate(amplitude = tmax - tmin) %>% filter(amplitude == max(amplitude))
# Adicionar anotações com setas
p <- figura +
theme_void() +
annotate(
"text",
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin) - 5,
label = "Menor temperatura aconteceu \nno outono: dia 13/11, 1°C",
hjust = 0,
vjust = 0,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax) + 5,
label = "O dia mais quente: \n22/09, 37°C",
hjust = 1,
vjust = -0.75,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_amplitude$date,
y = max(filtered_df$tmax) + 10,
label = "No dia 20/10 encarei uma diferença de 20°C \nentre as temperaturas mínima e máxima!",
hjust = 0.5,
vjust = 1,
size = 3,
color = "black") +
geom_curve(
aes(
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin),
xend = dia_com_menor_temperatura$date,
yend = min(filtered_df$tmin) - 2),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax),
xend = dia_com_maior_temperatura$date,
yend = max(filtered_df$tmax) + 8),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_amplitude$date,
y = (max(filtered_df$tmax) + min(filtered_df$tmin)) / 2,
xend = dia_com_maior_amplitude$date,
yend = max(filtered_df$tmax) + 4),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
theme(
axis.text.x = element_text(angle = 0, vjust = 0.5, size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold"), # Diminui o tamanho do título
plot.subtitle = ggtext::element_markdown()) # Use o markdown para o subtítulo# Diminui o tamanho do subtítulo
p
#| message: false
#| warning: false
# Use o ggtext para o subtitle que requer HTML
my_title <- glue(
"Temperaturas <b><span style = 'color:blue;'>mínimas</span></b> e <b><span style = 'color:orange;'>máximas</span></b> enquanto estive nos EUA"
)
# Cria o gráfico
figura <- ggplot(
filtered_df, aes(x = date)) +
geom_rect(aes(xmin = as.Date("2022-09-01"), xmax = as.Date("2022-09-06"), ymin = -Inf, ymax = Inf), fill = "red", alpha =0.01) +
geom_rect(aes(xmin = as.Date("2022-09-07"), xmax = as.Date("2022-12-22"), ymin = -Inf, ymax = Inf), fill = "orange", alpha = 0.01) +
geom_rect(aes(xmin = as.Date("2022-12-23"), xmax = max(filtered_df$date), ymin = -Inf, ymax = Inf), fill = "lightblue", alpha = 0.01) +
geom_segment(aes(x = date, xend = date, y = tmin, yend = tmax)) +
geom_point(aes(y = tmin), color = "blue", size = 1) +
geom_point(aes(y = tmax), color = "orange", size = 1) +
bbc_style() +
labs(title = my_title,
subtitle = "Registros diários dos lugares onde estive nos meses de setembro a agosto de 2022",
x = "Dia",
y = "Temperatura (°C)") +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
geom_vline(data = data.frame(date = seq(min(filtered_df$date), max(filtered_df$date), by = "1 month")),
aes(xintercept = date), linetype = "dashed", color = "gray") +
theme(axis.text.x = element_text(angle = 0, vjust = 0.5, hjust = -1, size = 10),
plot.subtitle = ggtext::element_markdown())
figura
#| message: false
#| warning: false
# Use o ggtext para o subtitle que requer HTML
my_title <- glue(
"Temperaturas <b><span style = 'color:blue;'>mínimas</span></b> e <b><span style = 'color:orange;'>máximas</span></b> enquanto estive nos EUA"
)
# Cria o gráfico
figura <- ggplot(
filtered_df, aes(x = date)) +
geom_rect(aes(xmin = as.Date("2022-09-01"), xmax = as.Date("2022-09-06"), ymin = -Inf, ymax = Inf), fill = "red", alpha =0.01) +
geom_rect(aes(xmin = as.Date("2022-09-07"), xmax = as.Date("2022-12-22"), ymin = -Inf, ymax = Inf), fill = "orange", alpha = 0.01) +
geom_rect(aes(xmin = as.Date("2022-12-23"), xmax = max(filtered_df$date), ymin = -Inf, ymax = Inf), fill = "lightblue", alpha = 0.01) +
geom_segment(aes(x = date, xend = date, y = tmin, yend = tmax)) +
geom_point(aes(y = tmin), color = "blue", size = 1) +
geom_point(aes(y = tmax), color = "orange", size = 1) +
bbc_style() +
labs(title = my_title,
subtitle = "Registros diários dos lugares onde estive nos meses de setembro a agosto de 2022",
x = "Dia",
y = "Temperatura (°C)") +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
geom_vline(data = data.frame(date = seq(min(filtered_df$date), max(filtered_df$date), by = "1 month")),
aes(xintercept = date), linetype = "dashed", color = "gray") +
theme(axis.text.x = element_text(angle = 0, vjust = 0.5, hjust = -1, size = 10),
plot.title = ggtext::element_markdown())
figura
#| message: false
#| warning: false
# Use o ggtext para o subtitle que requer HTML
my_title <- glue(
"Temperaturas <b><span style = 'color:blue;'>mínimas</span></b> e <b><span style = 'color:orange;'>máximas</span></b> enquanto estive nos EUA"
)
# Cria o gráfico
figura <- ggplot(
filtered_df, aes(x = date)) +
geom_rect(aes(xmin = as.Date("2022-09-01"), xmax = as.Date("2022-09-06"), ymin = -Inf, ymax = Inf), fill = "red", alpha =0.001) +
geom_rect(aes(xmin = as.Date("2022-09-07"), xmax = as.Date("2022-12-22"), ymin = -Inf, ymax = Inf), fill = "orange", alpha = 0.001) +
geom_rect(aes(xmin = as.Date("2022-12-23"), xmax = max(filtered_df$date), ymin = -Inf, ymax = Inf), fill = "lightblue", alpha = 0.001) +
geom_segment(aes(x = date, xend = date, y = tmin, yend = tmax)) +
geom_point(aes(y = tmin), color = "blue", size = 1) +
geom_point(aes(y = tmax), color = "orange", size = 1) +
bbc_style() +
labs(title = my_title,
subtitle = "Registros diários dos lugares onde estive nos meses de setembro a agosto de 2022",
x = "Dia",
y = "Temperatura (°C)") +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
geom_vline(data = data.frame(date = seq(min(filtered_df$date), max(filtered_df$date), by = "1 month")),
aes(xintercept = date), linetype = "dashed", color = "gray") +
theme(axis.text.x = element_text(angle = 0, vjust = 0.5, hjust = -1, size = 10),
plot.title = ggtext::element_markdown())
figura
dia_com_menor_temperatura <- filtered_df %>% filter(tmin == min(tmin))
dia_com_maior_temperatura <- filtered_df %>% filter(tmax == max(tmax))
dia_com_maior_amplitude <- filtered_df %>% mutate(amplitude = tmax - tmin) %>% filter(amplitude == max(amplitude))
# Adicionar anotações com setas
p <- figura +
theme_void() +
annotate(
"text",
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin) - 5,
label = "Menor temperatura aconteceu \nno outono: dia 13/11, 1°C",
hjust = 0,
vjust = 0,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax) + 5,
label = "O dia mais quente: \n22/09, 37°C",
hjust = 1,
vjust = -0.75,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_amplitude$date,
y = max(filtered_df$tmax) + 10,
label = "No dia 20/10 encarei uma diferença de 20°C \nentre as temperaturas mínima e máxima!",
hjust = 0.5,
vjust = 1,
size = 3,
color = "black") +
geom_curve(
aes(
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin),
xend = dia_com_menor_temperatura$date,
yend = min(filtered_df$tmin) - 2),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax),
xend = dia_com_maior_temperatura$date,
yend = max(filtered_df$tmax) + 8),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_amplitude$date,
y = (max(filtered_df$tmax) + min(filtered_df$tmin)) / 2,
xend = dia_com_maior_amplitude$date,
yend = max(filtered_df$tmax) + 4),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
theme(
axis.text.x = element_text(angle = 0, vjust = 0.5, size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold"), # Diminui o tamanho do título
plot.subtitle = ggtext::element_markdown()) # Use o markdown para o subtítulo# Diminui o tamanho do subtítulo
p
dia_com_menor_temperatura <- filtered_df %>% filter(tmin == min(tmin))
dia_com_maior_temperatura <- filtered_df %>% filter(tmax == max(tmax))
dia_com_maior_amplitude <- filtered_df %>% mutate(amplitude = tmax - tmin) %>% filter(amplitude == max(amplitude))
# Adicionar anotações com setas
p <- figura +
theme_void() +
annotate(
"text",
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin) - 5,
label = "Menor temperatura aconteceu \nno outono: dia 13/11, 1°C",
hjust = 0,
vjust = 0,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax) + 5,
label = "O dia mais quente: \n22/09, 37°C",
hjust = 1,
vjust = -0.75,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_amplitude$date,
y = max(filtered_df$tmax) + 10,
label = "No dia 20/10 encarei uma diferença de 20°C \nentre as temperaturas mínima e máxima!",
hjust = 0.5,
vjust = 1,
size = 3,
color = "black") +
geom_curve(
aes(
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin),
xend = dia_com_menor_temperatura$date,
yend = min(filtered_df$tmin) - 2),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax),
xend = dia_com_maior_temperatura$date,
yend = max(filtered_df$tmax) + 8),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_amplitude$date,
y = (max(filtered_df$tmax) + min(filtered_df$tmin)) / 2,
xend = dia_com_maior_amplitude$date,
yend = max(filtered_df$tmax) + 4),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
theme(
axis.text.x = element_text(angle = 0, vjust = 0.5, size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold"), # Diminui o tamanho do título
plot.title = ggtext::element_markdown()) # Use o markdown para o subtítulo# Diminui o tamanho do subtítulo
dia_com_menor_temperatura <- filtered_df %>% filter(tmin == min(tmin))
dia_com_maior_temperatura <- filtered_df %>% filter(tmax == max(tmax))
dia_com_maior_amplitude <- filtered_df %>% mutate(amplitude = tmax - tmin) %>% filter(amplitude == max(amplitude))
# Adicionar anotações com setas
p <- figura +
theme_void() +
annotate(
"text",
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin) - 5,
label = "Menor temperatura aconteceu \nno outono: dia 13/11, 1°C",
hjust = 0,
vjust = 0,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax) + 5,
label = "O dia mais quente: \n22/09, 37°C",
hjust = 1,
vjust = -0.75,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_amplitude$date,
y = max(filtered_df$tmax) + 10,
label = "No dia 20/10 encarei uma diferença de 20°C \nentre as temperaturas mínima e máxima!",
hjust = 0.5,
vjust = 1,
size = 3,
color = "black") +
geom_curve(
aes(
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin),
xend = dia_com_menor_temperatura$date,
yend = min(filtered_df$tmin) - 2),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax),
xend = dia_com_maior_temperatura$date,
yend = max(filtered_df$tmax) + 8),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_amplitude$date,
y = (max(filtered_df$tmax) + min(filtered_df$tmin)) / 2,
xend = dia_com_maior_amplitude$date,
yend = max(filtered_df$tmax) + 4),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
theme(
axis.text.x = element_text(angle = 0, vjust = 0.5, size = 10),
axis.text.y = element_text(size = 10),
plot.subtitle = element_text(size = 10), # Diminui o tamanho do título
plot.title = ggtext::element_markdown()) # Use o markdown para o subtítulo# Diminui o tamanho do subtítulo
p
library(ggplot2)
library(ggtext)
# Suponha que 'filtered_df' já está com 'date' no formato Date
# Encontrar os dias com os valores desejados
dia_com_menor_temperatura <- filtered_df %>% filter(tmin == min(tmin))
dia_com_maior_temperatura <- filtered_df %>% filter(tmax == max(tmax))
dia_com_maior_amplitude <- filtered_df %>% mutate(amplitude = tmax - tmin) %>% filter(amplitude == max(amplitude))
# Use o ggtext para o subtitle que requer HTML
my_title <- glue(
"Registros diários de temperaturas <b><span style = 'color:blue;'>mínimas</span></b> e <b><span style = 'color:orange;'>máximas</span></b> em Austin durante meu intercâmbio"
)
# Cria o gráfico com áreas coloridas de fundo
figura <- ggplot(filtered_df, aes(x = date)) +
geom_rect(aes(xmin = as.Date("2022-09-01"), xmax = as.Date("2022-09-06"), ymin = -Inf, ymax = Inf), fill = "red", alpha = 0.3) +
geom_rect(aes(xmin = as.Date("2022-09-07"), xmax = as.Date("2022-12-22"), ymin = -Inf, ymax = Inf), fill = "orange", alpha = 20) +
geom_rect(aes(xmin = as.Date("2022-12-23"), xmax = max(filtered_df$date), ymin = -Inf, ymax = Inf), fill = "lightblue", alpha = 0.3) +
geom_segment(aes(x = date, xend = date, y = tmin, yend = tmax)) +
geom_point(aes(y = tmin), color = "blue", size = 1) +
geom_point(aes(y = tmax), color = "orange", size = 1) +
labs(title = "Põe o casaco, tira o casaco",
subtitle = my_title,
x = "Dia",
y = "Temperatura (°C)") +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
geom_vline(data = data.frame(date = seq(min(filtered_df$date), max(filtered_df$date), by = "1 month")),
aes(xintercept = date), linetype = "dashed", color = "gray") +
theme(axis.text.x = element_text(angle = 0, vjust = 0.5, hjust = -1, size = 10))
# Adicionar as anotações e setas conforme necessário
p <- figura +
annotate(
"text",
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin) - 5,
label = "Menor temperatura aconteceu \nno outono: dia 13/11, 1°C",
hjust = 0,
vjust = 0,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax) + 5,
label = "O dia mais quente: \n22/09, 37°C",
hjust = 1,
vjust = -0.75,
size = 3,
color = "black") +
annotate(
"text",
x = dia_com_maior_amplitude$date,
y = max(filtered_df$tmax) + 10,
label = "No dia 20/10 encarei uma diferença de 20°C \nentre as temperaturas mínima e máxima!",
hjust = 0.5,
vjust = 1,
size = 3,
color = "black") +
geom_curve(
aes(
x = dia_com_menor_temperatura$date,
y = min(filtered_df$tmin),
xend = dia_com_menor_temperatura$date,
yend = min(filtered_df$tmin) - 2),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_temperatura$date,
y = max(filtered_df$tmax),
xend = dia_com_maior_temperatura$date,
yend = max(filtered_df$tmax) + 8),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
geom_curve(
aes(
x = dia_com_maior_amplitude$date,
y = (max(filtered_df$tmax) + min(filtered_df$tmin)) / 2,
xend = dia_com_maior_amplitude$date,
yend = max(filtered_df$tmax) + 4),
arrow = arrow(length = unit(0.1, "cm")), color = "black") +
theme(
axis.text.x = element_text(angle = 0, vjust = 0.5, size = 10),
axis.text.y = element_text(size = 10),
plot.title = element_text(size = 14, face = "bold"), # Diminui o tamanho do título
plot.subtitle = ggtext::element_markdown()) + # Use o markdown para o subtítulo
theme_void()
p
